  begin pgp signed message     httpaddr security advisory freebsd project topic  bug nfs server code allows remote denial service category  core module  nfs announced  numbernumbernumber credit  mike junk affect  release prior numbernumbernumberreleasepnumber numbernumberstable prior correction date corrected  numbernumbernumber number  number  number utc  relengnumber  numbernumbernumber number  number  number utc  relengnumbernumber  numbernumbernumber number  number  number utc  relengnumbernumber  numbernumbernumber number  number  number utc  relengnumbernumber  freebsd  i background network file system  nfs  allows host export filesystems  part  host access network mount local disk  nfs built top sun remote procedure call  rpc  framework  ii  problem description part nfs server code charged handling incoming rpc message error  server received message zerolength payload  would cause reference payload previous message  creating loop message chain  would later cause infinite loop different part nfs server code tried traverse chain  iii  impact certain linux implementation nfs produce zerolength rpc message case  freebsd system running nfs server may lock client connect  attacker position send rpc message affected freebsd system construct sequence malicious rpc message cause target system lock  iv  workaround number  disable nfs server  set nfsserverenable variable   httpaddr  reboot  alternatively  active nfs client  listed showmount  number  utility   killing mountd nfsd process suffice  number  add firewall rule block rpc traffic nfs server untrusted host  v solution following patch verified apply freebsd numbernumber  numbernumber  numbernumber system   download relevant patch location  verify detached pgp signature using pgp utility   fetch httpaddr  fetch httpaddr b  apply patch   cd usrsrc  patch reboot system  vi  correction detail following list contains revision number file corrected freebsd  path revision branch                                       srcsysnfsnfssocketc relengnumber numbernumbernumbernumber relengnumbernumber numbernumbernumbernumbernumbernumber relengnumbernumber numbernumbernumbernumbernumbernumber relengnumbernumber numbernumbernumbernumbernumbernumber                                         begin pgp signature    version  gnupg vnumbernumbernumber  freebsd  iqcvawubpunumberntvuuhinumberznumberoilaqhmzaplnumberqudeelkhfzyxgnumberppfnumbercuwkreacavl lpnumberojdhlwuwnumberknumbertmnumberyvnumbertunumberwgnlnumberdsqwkfemzxlhzfsmrbubqxnumberefgonumbersb nheetsfunumbertnumberylhtyqewftrwebnumberanumbertgjayvnumberwybwzxulkyjnumberqnrlkfnumberptocnumberenumber tnumberycnnumberdnya numberysa   end pgp signature   
